

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Security &mdash; tiled 0.1.0a24.post5+g42ae249 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Access Control" href="access-control.html" />
    <link rel="prev" title="Structures" href="structures.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> tiled
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0a24.post5+g42ae249
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/navigation.html">Navigate with the Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/slicing.html">Load Slices of Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/caching.html">Keep a Local Copy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/export.html">Deliberate Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/serving-files.html">Serve a Directory of Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/search.html">Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/plotly-integration.html">Plot Data in Plotly Chart Studio</a></li>
</ul>
<p class="caption"><span class="caption-text">How To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how-to/configuration.html">Serve Trees using Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/custom-formats.html">Add Support for a Custom Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/profiles.html">Use Profiles to streamline Python client setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/direct-client.html">Use Tiled in Python without an HTTP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/scaling.html">Control Speed, Memory Usage, and Disk Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Explanations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="structures.html">Structures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#secure-single-user-server">Secure single-user server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#public-data-service">Public data service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#private-multi-user-data-service">Private multi-user data service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#authenticate-with-local-linux-unix-users">Authenticate with local Linux/UNIX users</a></li>
<li class="toctree-l3"><a class="reference internal" href="#toy-examples">Toy examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#multi-user-data-service-with-some-public-and-some-private-content">Multi-user data service with some public and some private content</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html">Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="lineage.html">How Tiled Fits into the Ecosystem</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/service.html">Service-side Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/http-api-overview.html">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/python-client.html">Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/authentication.html">Authentication Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/commandline.html">Command-line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/service-configuration.html">Service Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/client-profiles.html">Client Profiles Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/design-documents/index.html">Design Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/min-versions.html">Minimum Version of Python and NumPy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tiled</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Security</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/explanations/security.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="security">
<h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<p>Tiled employs modern web security standards to enforce access control with
minimum inconvenience to the user.</p>
<p>There are four use cases for the Tiled server.</p>
<ol class="simple">
<li><p>Secure single-user server, analogous to how people use <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code></p></li>
<li><p>Public data service</p></li>
<li><p>Private multi-user data service</p></li>
<li><p>Multi-user data service with some public and some private content</p></li>
</ol>
<p>We address each in turn below.</p>
<div class="section" id="secure-single-user-server">
<h2>Secure single-user server<a class="headerlink" href="#secure-single-user-server" title="Permalink to this headline">¶</a></h2>
<p>In this mode, a single user or small group of highly trusted users have access
to a Tiled server protected by a secret access token. This is the default mode.
For those familiar with Jupyter, this is very similar to how
<code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code> works.</p>
<p>At startup, a secret token is generated and logged in the terminal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tiled serve pyobject tiled.examples.generated_minimal:tree

    Use the following URL to connect to Tiled:

    &quot;http://127.0.0.1:8000?api_key=a4062c3dd6ab2af0d28fdb7eb278dd985c462ecf08d39f33233554c7fdaa42e7&quot;
</pre></div>
</div>
<p>where the token after <code class="docutils literal notranslate"><span class="pre">api_key=</span></code> will be different each time you start the
server. Once you have visited this URL with your web browser or the Tiled Python
client, a cookie will be set in your client and you won’t need to use the token
again. It is valid indefinitely.</p>
<p>For horizontally-scaled deployments where you need multiple instances of the
server to share the same secret, you can set it via an environment variable like
so.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TILED_SINGLE_USER_API_KEY</span><span class="o">=</span><span class="n">YOUR_SECRET</span> <span class="n">tiled</span> <span class="n">serve</span> <span class="o">...</span>
</pre></div>
</div>
<p>or via the configuration parameter</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">authentication</span><span class="p">:</span>
  <span class="nt">single_user_api_key</span><span class="p">:</span> <span class="s">&quot;...&quot;</span>
</pre></div>
</div>
<p>When the secret is set manually it this way, it is <em>not</em> logged in the terminal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When generating a secret, is important to produce a difficult-to-guess random
number, and make it different each time you start up a server.  Two equally good
ways to generate a secure secret…</p>
<p>With <code class="docutils literal notranslate"><span class="pre">openssl</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>openssl rand -hex 32
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">python</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python -c &quot;import secrets; print(secrets.token_hex(32))&quot;
</pre></div>
</div>
</div>
</div>
<div class="section" id="public-data-service">
<h2>Public data service<a class="headerlink" href="#public-data-service" title="Permalink to this headline">¶</a></h2>
<p>Tiled can serve a public data repository with no authentication required. To
launch it in this mode, use the <code class="docutils literal notranslate"><span class="pre">--public</span></code> flag as in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="p">{</span><span class="n">pyobject</span><span class="p">,</span> <span class="n">directory</span><span class="p">}</span> <span class="o">--</span><span class="n">public</span> <span class="o">...</span>
</pre></div>
</div>
<p>When the server is started in this way, it will log a notice like
the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tiled serve pyobject --public tiled.examples.generated_minimal:tree

    Tiled server is running in &quot;public&quot; mode, permitting open, anonymous access.
    Any data that is not specifically controlled with an access policy
    will be visible to anyone who can connect to this server.

</pre></div>
</div>
<p>Alternatively, if using a configuration file as in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="n">config</span> <span class="o">...</span>
</pre></div>
</div>
<p>include the configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">allow_anonymous_access</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>This is a complete working example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># config.yml</span>
<span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">allow_anonymous_access</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">trees</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
      <span class="nt">tree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.examples.generated_minimal:tree</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="n">config</span> <span class="n">config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>As above, a notice will be logged that the server is public.</p>
</div>
<div class="section" id="private-multi-user-data-service">
<h2>Private multi-user data service<a class="headerlink" href="#private-multi-user-data-service" title="Permalink to this headline">¶</a></h2>
<p>In this mode, users <em>must</em> log in to access anything other than the root <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/</span></code>
and documentation <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/docs</span></code> routes.</p>
<p>Tiled is designed to integrate with external user-management systems via a pluggable
Authenticator interface. For those familiar with JupyterHub, these are very
similar to JupyterHub Authenticators. Authenticators fall into two groups:</p>
<ul class="simple">
<li><p>Authenticators that accept user credentials directly at the <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/token</span></code>
endpoint, following the OAuth2 and OpenAPI standards as shown below, and
validate the credentials using some underlying authentication mechanism, such
as PAM.</p></li>
<li><p>Authenticators that use OAuth2 code flow to validate user credentials
without directly handling them. (No such Authenticators have been written yet
for Tiled, but track to do so has been laid, closely following the pattern
established by JupyterHub.)</p></li>
</ul>
<p>This mode requires configuration files to be used, as in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="n">config</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">config_file</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>in order to specify the Authenticator and, when applicable, any parameters.
The shorthands <code class="docutils literal notranslate"><span class="pre">tiled</span> <span class="pre">serve</span> <span class="pre">pyobject</span> <span class="pre">...</span></code> and <code class="docutils literal notranslate"><span class="pre">tiled</span> <span class="pre">serve</span> <span class="pre">directory</span> <span class="pre">...</span></code>
do not currently support this mode. See below for complete working examples.</p>
<p>The server implements “sliding sessions”, meaning that the user provides their
login credentials once and the server keep their session alive for as long as
they are actively using it—up to some optional, configurable limit.</p>
<p>You may configure:</p>
<ul class="simple">
<li><p>The maximum time to keep an <em>inactive</em> session alive (default is one week)</p></li>
<li><p>The maximum session lifetime (default is unlimited)</p></li>
<li><p>Access token lifetime. This is internal from the user’s point of view
It should be short. (Default 15 minutes.)</p></li>
</ul>
<p>See <a class="reference internal" href="../reference/authentication.html"><span class="doc">Authentication Details</span></a> for advanced customization options and
additional details.</p>
<div class="section" id="authenticate-with-local-linux-unix-users">
<h3>Authenticate with local Linux/UNIX users<a class="headerlink" href="#authenticate-with-local-linux-unix-users" title="Permalink to this headline">¶</a></h3>
<p>This requires an additional dependency.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pamela</span>
</pre></div>
</div>
<p>The configuration file(s) should include:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">authenticator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.authenticators:PAMAuthenticator</span>
</pre></div>
</div>
<p>Here is a complete working example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># pam_config.yml</span>
<span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">authenticator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.authenticators:PAMAuthenticator</span>
<span class="nt">trees</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
      <span class="nt">tree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.examples.generated_minimal:tree</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="n">config</span> <span class="n">pam_config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>Authenticate using a system user account and password.</p>
</div>
<div class="section" id="toy-examples">
<h3>Toy examples<a class="headerlink" href="#toy-examples" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">DictionaryAuthenticator</span></code> authenticates using usernames and passwords
specified directly in the configuration. The passwords may be extracted from
environment variables, as shown. This is not a robust user management system and
should only for used for development and demos.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># dictionary_config.yml</span>
<span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">authenticator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.authenticators:DictionaryAuthenticator</span>
    <span class="nt">args</span><span class="p">:</span>
        <span class="nt">users_to_passwords</span><span class="p">:</span>
            <span class="nt">alice</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${ALICE_PASSWORD}</span>
            <span class="nt">bob</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${BOB_PASSWORD}</span>
            <span class="nt">cara</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${CARA_PASSWORD}</span>
<span class="nt">trees</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
      <span class="nt">tree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.examples.generated_minimal:tree</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALICE_PASSWORD</span><span class="o">=</span><span class="n">secret1</span> <span class="n">BOB_PASSWORD</span><span class="o">=</span><span class="n">secret2</span> <span class="n">CARA_PASSWORD</span><span class="o">=</span><span class="n">secret3</span> <span class="n">tiled</span> <span class="n">serve</span> <span class="n">config</span> <span class="n">dictionary_config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">DummyAuthenticator</span></code> accepts <em>any</em> username and password combination.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># dummy_config.yml</span>
<span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">authenticator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.authenticators:DummyAuthenticator</span>
<span class="nt">trees</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
      <span class="nt">tree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.examples.generated_minimal:tree</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="n">config</span> <span class="n">dummy_config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>To control which users can see which entries in the Trees, see
<a class="reference internal" href="access-control.html"><span class="doc">Access Control</span></a>.</p>
</div>
</div>
<div class="section" id="multi-user-data-service-with-some-public-and-some-private-content">
<h2>Multi-user data service with some public and some private content<a class="headerlink" href="#multi-user-data-service-with-some-public-and-some-private-content" title="Permalink to this headline">¶</a></h2>
<p>When an Authenticator is used in conjunction with <a class="reference internal" href="access-control.html"><span class="doc">Access Control</span></a>,
certain entries may be designated as “public”, visible to any user. By default,
visitors still need to be authenticated (as any user) to see these entries.
To make such entries visible to <em>anonymous</em>, unauthenticated users as well,
include the configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">allow_anonymous_access</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="../reference/service-configuration.html"><span class="doc">Service Configuration Reference</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="access-control.html" class="btn btn-neutral float-right" title="Access Control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="structures.html" class="btn btn-neutral float-left" title="Structures" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Bluesky Collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>