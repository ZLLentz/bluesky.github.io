
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Navigate Metadata in a Run &mdash; databroker 1.2.5.post15+g5fbc5eb1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Export Data" href="export.html" />
    <link rel="prev" title="Get Data from a Run" href="get-data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> databroker
          </a>
              <div class="version">
                1.2.5.post15+g5fbc5eb1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="search-and-lookup.html">Find Runs in a Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-data.html">Get Data from a Run</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Navigate Metadata in a Run</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#set-up-for-tutorial">Set up for Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-configuration">(Hardware) Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-it-started">How It Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-it-ended">How It Ended</a></li>
<li class="toctree-l2"><a class="reference internal" href="#low-level-hardware-timestamps">Low-level Hardware Timestamps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="export.html">Export Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how-to/download-data-samples.html">How to download some Catalogs with data samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/file-backed-catalog.html">How to create a new Catalog backed by files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/store-data-from-run-engine.html">How to store data from the Run Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/store-analysis-results.html">How to store analysis results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/mongo-backed-catalog.html">How to create a new Catalog backed by MongoDB</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Explanations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../explanations/v2-transition.html">What are the API versions v0, v1, v2?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/local-and-remote-use-cases.html">How can it be used locally and remotely?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/relationship-to-intake.html">What is Databroker’s relationship to Intake?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/v2.html">New (v2) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/v1.html">Original (v1 / v0) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/configuration.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bluesky Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io">Homepage</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bluesky">GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://gitter.im/NSLS-II/DAMA">Gitter</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">databroker</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Navigate Metadata in a Run</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/get-metadata.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="navigate-metadata-in-a-run">
<h1>Navigate Metadata in a Run<a class="headerlink" href="#navigate-metadata-in-a-run" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will access secondary measurements and metadata including:</p>
<ul class="simple">
<li><p>Hardware configuration readings (e.g. exposure time)</p></li>
<li><p>User-provided context like sample information</p></li>
<li><p>Whether the Run completed with an error (and if so what error)</p></li>
<li><p>Hardware-level timestamps for each measurement</p></li>
</ul>
<section id="set-up-for-tutorial">
<h2>Set up for Tutorial<a class="headerlink" href="#set-up-for-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Before you begin, install <code class="docutils literal notranslate"><span class="pre">databroker</span></code> and <code class="docutils literal notranslate"><span class="pre">databroker-pack</span></code>, following the
<a class="reference internal" href="install.html"><span class="doc">Installation Tutorial</span></a>.</p>
<p>Start your favorite interactive Python environment, such as <code class="docutils literal notranslate"><span class="pre">ipython</span></code> or
<code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code>.</p>
<p>For this tutorial, we’ll use a catalog of publicly available, openly licensed
sample data. Specifically, it is high-quality transmission XAS data from all
over the periodical table.</p>
<p>This utility downloads it and makes it discoverable to Databroker.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">databroker.tutorial_utils</span>

<span class="gp">In [2]: </span><span class="n">databroker</span><span class="o">.</span><span class="n">tutorial_utils</span><span class="o">.</span><span class="n">fetch_BMM_example</span><span class="p">()</span>
<span class="gh">Out[2]: </span><span class="go">bluesky-tutorial-BMM:</span>
<span class="go">  args:</span>
<span class="go">    name: bluesky-tutorial-BMM</span>
<span class="go">    paths:</span>
<span class="go">    - /home/runner/.local/share/bluesky_tutorial_data/bluesky-tutorial-BMM/documents/*.msgpack</span>
<span class="go">    root_map: {}</span>
<span class="go">  description: &#39;&#39;</span>
<span class="go">  driver: databroker._drivers.msgpack.BlueskyMsgpackCatalog</span>
<span class="go">  metadata:</span>
<span class="go">    catalog_dir: /home/runner/.local/share/intake/</span>
<span class="go">    generated_by:</span>
<span class="go">      library: databroker_pack</span>
<span class="go">      version: 0.3.0</span>
<span class="go">    relative_paths:</span>
<span class="go">    - ./documents/*.msgpack</span>
</pre></div>
</div>
<p>Access the catalog and assign it to a variable for convenience.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">databroker</span>

<span class="gp">In [4]: </span><span class="n">catalog</span> <span class="o">=</span> <span class="n">databroker</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;bluesky-tutorial-BMM&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s take a Run from this Catalog.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">run</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="mi">23463</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="hardware-configuration">
<h2>(Hardware) Configuration<a class="headerlink" href="#hardware-configuration" title="Permalink to this headline">¶</a></h2>
<p>The Run may include configurational readings necessary for interpreting the
data. These are typically things that change slowly or not at all during the
Run, like detector exposure time, detector gain settings, or the configured
maximum motor velocity.</p>
<p>First, let’s look at the <code class="docutils literal notranslate"><span class="pre">I0</span></code> readings in the <code class="docutils literal notranslate"><span class="pre">primary</span></code> stream. What are
the configuration readings that might be necessary to interpret this data or
compare it with other data?</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">da</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="s2">&quot;I0&quot;</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="n">da</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">&lt;xarray.DataArray &#39;I0&#39; (time: 5)&gt;</span>
<span class="go">array([135.16644077, 134.97916279, 134.78557224, 134.63573771,</span>
<span class="go">       134.70294218])</span>
<span class="go">Coordinates:</span>
<span class="go">  * time     (time) float64 1.584e+09 1.584e+09 1.584e+09 1.584e+09 1.584e+09</span>
<span class="go">Attributes:</span>
<span class="go">    object:   quadem1</span>
</pre></div>
</div>
<p>This section at the bottom of that summary</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Attributes</span><span class="p">:</span>
    <span class="nb">object</span><span class="p">:</span>   <span class="n">quadem1</span>
</pre></div>
</div>
<p>is showing us that <code class="docutils literal notranslate"><span class="pre">I0</span></code> was measured by the device <code class="docutils literal notranslate"><span class="pre">quadem1</span></code>. We can also
access that programmatically like</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">&#39;quadem1&#39;</span>
</pre></div>
</div>
<p>We can then look up all the configuration readings associated with <code class="docutils literal notranslate"><span class="pre">quadem1</span></code>
in this stream.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">run</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;quadem1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:                   (time: 411)</span>
<span class="go">Coordinates:</span>
<span class="go">  * time                      (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">Data variables:</span>
<span class="go">    quadem1_integration_time  (time) float64 0.0004 0.0004 ... 0.0004 0.0004</span>
<span class="go">    quadem1_averaging_time    (time) float64 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</span>
<span class="go">    quadem1_em_range          (time) &lt;U6 &#39;350 pC&#39; &#39;350 pC&#39; ... &#39;350 pC&#39; &#39;350 pC&#39;</span>
<span class="go">    quadem1_values_per_read   (time) int64 5 5 5 5 5 5 5 5 5 ... 5 5 5 5 5 5 5 5</span>
<span class="go">    quadem1_num_averaged      (time) int64 250 250 250 250 ... 250 250 250 250</span>
</pre></div>
</div>
<p>If another Run ran the <code class="docutils literal notranslate"><span class="pre">quadem1</span></code> detector with a <em>different</em> integration
time, we could use this information to normalize the readings and compare them
accurately.</p>
<p>TO DO: Get an example of that.</p>
<p>Let’s look at some other readings in the dataset. The <code class="docutils literal notranslate"><span class="pre">It</span></code> also comes from
<code class="docutils literal notranslate"><span class="pre">quadem1</span></code>, so those same configuration readings apply.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;It&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
<span class="gh">Out[10]: </span><span class="go">{&#39;object&#39;: &#39;quadem1&#39;}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dcm_energy``readings,</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">other</span> <span class="pre">hand,</span> <span class="pre">comes</span> <span class="pre">from</span> <span class="pre">a</span> <span class="pre">different</span> <span class="pre">device,</span>
<span class="pre">which</span> <span class="pre">happens</span> <span class="pre">to</span> <span class="pre">also</span> <span class="pre">be</span> <span class="pre">named</span> <span class="pre">``dcm_energy</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;dcm_energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
<span class="gh">Out[11]: </span><span class="go">{&#39;object&#39;: &#39;dcm_energy&#39;}</span>
</pre></div>
</div>
<p>We can see that no configuration was recorded for that device.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">run</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;dcm_energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gh">Out[12]: </span><span class="go"></span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:  ()</span>
<span class="go">Data variables:</span>
<span class="go">    *empty*</span>
</pre></div>
</div>
</section>
<section id="how-it-started">
<h2>How It Started<a class="headerlink" href="#how-it-started" title="Permalink to this headline">¶</a></h2>
<p>There are many useful pieces of metadata that we know at the <strong>start</strong>, before
we begin acquiring data or running data processing/analysis. This includes what
we intend to do (i.e. which scan type or which data processing routine), who is
doing it, and any additional context like sample information.</p>
<p>The only fields <em>guaranteed</em> by Databroker to be present are <code class="docutils literal notranslate"><span class="pre">uid</span></code> (a
globally unique identifier for the Run) and <code class="docutils literal notranslate"><span class="pre">time</span></code> (when it started) but
there is often a great deal more.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
<span class="go">Start({</span>
<span class="go">&#39;XDI&#39;: {&#39;Beamline&#39;: {&#39;collimation&#39;: &#39;paraboloid mirror, 5 nm Rh on 30 nm Pt&#39;,</span>
<span class="go">                   &#39;focusing&#39;: &#39;not in use&#39;,</span>
<span class="go">                   &#39;harmonic_rejection&#39;: &#39;flat mirror, Pt stripe, pitch = &#39;</span>
<span class="go">                                         &#39;7.0 mrad relative to beam&#39;,</span>
<span class="go">                   &#39;name&#39;: &#39;BMM (06BM) -- Beamline for Materials &#39;</span>
<span class="go">                           &#39;Measurement&#39;,</span>
<span class="go">                   &#39;xray_source&#39;: &#39;NSLS-II three-pole wiggler&#39;},</span>
<span class="go">      &#39;Column&#39;: {},</span>
<span class="go">      &#39;Detector&#39;: {&#39;I0&#39;: &#39;10 cm N2&#39;, &#39;Ir&#39;: &#39;25 cm N2&#39;, &#39;It&#39;: &#39;25 cm N2&#39;},</span>
<span class="go">      &#39;Element&#39;: {&#39;edge&#39;: &#39;K&#39;, &#39;symbol&#39;: &#39;Ni&#39;},</span>
<span class="go">      &#39;Facility&#39;: {&#39;GUP&#39;: 305832,</span>
<span class="go">                   &#39;SAF&#39;: 305669,</span>
<span class="go">                   &#39;current&#39;: &#39;399.6&#39;,</span>
<span class="go">                   &#39;cycle&#39;: &#39;2020-1&#39;,</span>
<span class="go">                   &#39;energy&#39;: &#39;3.0&#39;,</span>
<span class="go">                   &#39;mode&#39;: &#39;top-off&#39;,</span>
<span class="go">                   &#39;name&#39;: &#39;NSLS-II&#39;},</span>
<span class="go">      &#39;Mono&#39;: {&#39;angle_offset&#39;: 16.058109,</span>
<span class="go">               &#39;d_spacing&#39;: &#39;3.1353241&#39;,</span>
<span class="go">               &#39;direction&#39;: &#39;forward&#39;,</span>
<span class="go">               &#39;encoder_resolution&#39;: 5e-06,</span>
<span class="go">               &#39;name&#39;: &#39;Si(111)&#39;,</span>
<span class="go">               &#39;scan_mode&#39;: &#39;fixed exit&#39;,</span>
<span class="go">               &#39;scan_type&#39;: &#39;step&#39;},</span>
<span class="go">      &#39;Sample&#39;: {&#39;name&#39;: &#39;Ni&#39;, &#39;prep&#39;: &#39;Ni foil in ref&#39;},</span>
<span class="go">      &#39;Scan&#39;: {&#39;edge_energy&#39;: 8332.800000000001,</span>
<span class="go">               &#39;experimenters&#39;: &#39;Neil Hyatt, Martin Stennett, Dan Austin, &#39;</span>
<span class="go">                                &#39;Seb Lawson&#39;},</span>

<span class="go"> ...  # snipped for brevity</span>
<span class="go"> }</span>
</pre></div>
</div>
</section>
<section id="how-it-ended">
<h2>How It Ended<a class="headerlink" href="#how-it-ended" title="Permalink to this headline">¶</a></h2>
<p>There are other things we can only know at the <strong>stop</strong> (end) of an experiment,
including when and how it finished and how many events (rows) of data were
collected in each stream.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">run</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;stop&quot;</span><span class="p">]</span>
<span class="gh">Out[13]: </span><span class="go"></span>
<span class="go">Stop({&#39;exit_status&#39;: &#39;success&#39;,</span>
<span class="go"> &#39;num_events&#39;: {&#39;baseline&#39;: 2, &#39;primary&#39;: 411},</span>
<span class="go"> &#39;run_start&#39;: &#39;4393404b-8986-4c75-9a64-d7f6949a9344&#39;,</span>
<span class="go"> &#39;time&#39;: 1583577680.5466747,</span>
<span class="go"> &#39;uid&#39;: &#39;1548ec1e-1a01-4df2-9a2b-e17927971c58&#39;})</span>
</pre></div>
</div>
<p>We can use this to print the unique IDs of any experiments that failed</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">   ....: </span>    <span class="k">if</span> <span class="n">run</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;stop&quot;</span><span class="p">][</span><span class="s2">&quot;exit_status&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run </span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2"> failed!&quot;</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>or, getting a bit fancier, to tally the number of failures.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="gp">In [16]: </span><span class="n">counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>

<span class="gp">In [17]: </span><span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">   ....: </span>    <span class="n">counter</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">run</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;stop&quot;</span><span class="p">][</span><span class="s2">&quot;exit_status&quot;</span><span class="p">]:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gp">   ....: </span>

<span class="gp">In [18]: </span><span class="n">counter</span>
<span class="gh">Out[18]: </span><span class="go">Counter({&#39;success&#39;: 123})</span>
</pre></div>
</div>
<p>TO DO: Obtain an example catalog that has some failures in it so that this
example is not so trivial.</p>
</section>
<section id="low-level-hardware-timestamps">
<h2>Low-level Hardware Timestamps<a class="headerlink" href="#low-level-hardware-timestamps" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any <em>preicse</em> timing measurements should be in the data itself, not in this
supplemental hardware timestamp metadata. This should generally be
considered good for ~0.1 second precision alignment.</p>
</div>
<p>Control systems provide us with individually timestamps for every reading.
These should generally <em>not</em> be used for data analysis. Any timing readings
necessary for analysis should be recorded as data, as a column in some stream.
These are intended to be used for debugging and troubleshooting.</p>
<p>The timestamps associated with the readings in <code class="docutils literal notranslate"><span class="pre">run.primary.read()</span></code> are
available as</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">run</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gh">Out[19]: </span><span class="go"></span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:                   (time: 411)</span>
<span class="go">Coordinates:</span>
<span class="go">  * time                      (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">Data variables:</span>
<span class="go">    I0                        (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    It                        (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    Ir                        (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    dwti_dwell_time           (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    dwti_dwell_time_setpoint  (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    dcm_energy                (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    dcm_energy_setpoint       (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
</pre></div>
</div>
<p>Configuration readings also come with timestamps. The timestamps associated
with the configuration readings in <code class="docutils literal notranslate"><span class="pre">run.primary.config[&quot;quadem1&quot;].read()</span></code> are
available as</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">run</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">config_timestamps</span><span class="p">[</span><span class="s2">&quot;quadem1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:                   (time: 411)</span>
<span class="go">Coordinates:</span>
<span class="go">  * time                      (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">Data variables:</span>
<span class="go">    quadem1_integration_time  (time) float64 1.578e+09 1.578e+09 ... 1.578e+09</span>
<span class="go">    quadem1_averaging_time    (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">    quadem1_em_range          (time) float64 1.578e+09 1.578e+09 ... 1.578e+09</span>
<span class="go">    quadem1_values_per_read   (time) float64 1.578e+09 1.578e+09 ... 1.578e+09</span>
<span class="go">    quadem1_num_averaged      (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="get-data.html" class="btn btn-neutral float-left" title="Get Data from a Run" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="export.html" class="btn btn-neutral float-right" title="Export Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015 Brookhaven National Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>